<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jonathan Kitt">
<meta name="dcterms.date" content="2022-12-12">

<title>Ateliers codons - Introduction à GitLab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Ateliers codons</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/codons-blog/"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Introduction à GitLab</h1>
            <p class="subtitle lead">Connecter RStudio à GitLab et assurer le suivi de version</p>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">RStudio</div>
                <div class="quarto-category">GitLab</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jonathan Kitt </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 12, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Sommaire</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#git-github-et-gitlab" id="toc-git-github-et-gitlab" class="nav-link" data-scroll-target="#git-github-et-gitlab">Git, GitHub et GitLab</a></li>
  <li><a href="#installer-git" id="toc-installer-git" class="nav-link" data-scroll-target="#installer-git">Installer git</a></li>
  </ul></li>
  <li><a href="#premiers-pas-avec-git" id="toc-premiers-pas-avec-git" class="nav-link" data-scroll-target="#premiers-pas-avec-git">Premiers pas avec git</a>
  <ul class="collapse">
  <li><a href="#en-ligne-de-commande" id="toc-en-ligne-de-commande" class="nav-link" data-scroll-target="#en-ligne-de-commande">En ligne de commande</a></li>
  <li><a href="#en-clique-bouton" id="toc-en-clique-bouton" class="nav-link" data-scroll-target="#en-clique-bouton">En “clique-bouton”</a></li>
  </ul></li>
  <li><a href="#de-gitlab-vers-rstudio" id="toc-de-gitlab-vers-rstudio" class="nav-link" data-scroll-target="#de-gitlab-vers-rstudio">De GitLab vers RStudio</a>
  <ul class="collapse">
  <li><a href="#dans-gitlab" id="toc-dans-gitlab" class="nav-link" data-scroll-target="#dans-gitlab">Dans GitLab</a></li>
  <li><a href="#dans-rstudio" id="toc-dans-rstudio" class="nav-link" data-scroll-target="#dans-rstudio">Dans RStudio</a></li>
  <li><a href="#workflow" id="toc-workflow" class="nav-link" data-scroll-target="#workflow">Workflow</a></li>
  <li><a href="#historique-des-modifications" id="toc-historique-des-modifications" class="nav-link" data-scroll-target="#historique-des-modifications">Historique des modifications</a></li>
  </ul></li>
  <li><a href="#de-rstudio-vers-gitlab" id="toc-de-rstudio-vers-gitlab" class="nav-link" data-scroll-target="#de-rstudio-vers-gitlab">De RStudio vers GitLab</a>
  <ul class="collapse">
  <li><a href="#dans-rstudio-2" id="toc-dans-rstudio-2" class="nav-link" data-scroll-target="#dans-rstudio-2">Dans RStudio</a></li>
  <li><a href="#dans-gitlab-2" id="toc-dans-gitlab-2" class="nav-link" data-scroll-target="#dans-gitlab-2">Dans GitLab</a></li>
  <li><a href="#dans-rstudio-3" id="toc-dans-rstudio-3" class="nav-link" data-scroll-target="#dans-rstudio-3">Dans RStudio</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p><br></p>
<section id="git-github-et-gitlab" class="level2">
<h2 class="anchored" data-anchor-id="git-github-et-gitlab">Git, GitHub et GitLab</h2>
<p><br></p>
<p>Lorsqu’on travaille sur des données ou qu’on rédige un rapport, on peut rapidement se retrouver avec beaucoup de fichiers aux noms plus ou moins explicites : <code>fichier.txt</code>, <code>fichier2.txt</code>, <code>fichier2_modifs.txt</code>, <code>fichier2_version1.txt</code>, … Difficile de s’y retrouver !</p>
<p><br></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/git_notfinal.gif" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Dessing de PHDComics</figcaption><p></p>
</figure>
</div>
<p><br></p>
<p><a href="https://git-scm.com/"><strong>Git</strong></a> est un <em>gestionnaire de versions</em>, gratuit et open source qui permet de garder une trace de toutes les modifications apportées à un fichier.</p>
<p>Git vous permet de “figer” l’état de votre répertoire de travail à un instant donné à l’aide de <strong>commits</strong>.</p>
<p>Vous pourrez ainsi naviguer dans l’historique des modifications d’un fichier, savoir quand une modification a été faite et en quoi consiste cette modification.</p>
<p>Vous pourrez revenir à un état antérieur de votre fichier en remontant dans l’historique des modifications.</p>
<p>Git vous permet également de travailler sur des <strong>branches</strong>. La branche principale sur laquelle se situe votre travail “propre” se nomme la branche <strong>master</strong>. Vous pouvez créer une seconde branche pour effectuer des tests, faire du développement, tout en laissant intacte la branche master. Vous pourrez inclure les modifications apportées sur la seconde branche dans la branche master en les fusionnant : c’est ce qu’on appelle un <strong>merge</strong>.</p>
<p>Git vous permet également de faire une sauvegarde de vos modifications sur un serveur distant : <a href="https://github.com/"><strong>Github</strong></a> ou <a href="https://gitlab.com"><strong>Gitlab</strong></a>. Ces outils permettent de travailler à plusieurs sur un même projet, de synchroniser vos répertoires locaux et distants, de partager votre code, …</p>
<p><br></p>
</section>
<section id="installer-git" class="level2">
<h2 class="anchored" data-anchor-id="installer-git">Installer git</h2>
<p><br></p>
<section id="windows" class="level3">
<h3 class="anchored" data-anchor-id="windows">Windows</h3>
<p><br></p>
<p>Sur le site de <a href="https://gitforwindows.org/">git</a>, téléchargez la dernière version de git.</p>
<p><img src="img/git_01.png" class="img-fluid" style="width:100.0%"></p>
<p>Double-cliquez sur l’exécutable <code>Git-xxxx.exe</code> :</p>
<p><img src="img/git_03.png" class="img-fluid" style="width:100.0%"></p>
<p>Laissez les paramètres par défaut proposés par l’assistant d’installation. Dans le menu <em>Choosing the default editor used by Git</em>, vous pouvez laisser l’éditeur de texte proposé par défaut (Vim) ou choisir l’éditeur de texte que vous avez l’habitude d’utiliser.</p>
<p><img src="img/git_04.png" class="img-fluid" style="width:50.0%"></p>
<p>Dans les menus suivants, laissez les paramètres suivants jusqu’à ce que l’installation de <code>git</code> soit complétée.</p>
<p><br></p>
</section>
<section id="linux" class="level3">
<h3 class="anchored" data-anchor-id="linux">Linux</h3>
<p>Suivez les instructions sur <a href="https://git-scm.com/download/linux">ce lien</a>.</p>
<p><br></p>
</section>
<section id="macos" class="level3">
<h3 class="anchored" data-anchor-id="macos">MacOS</h3>
<p>Suivez les instructions sur <a href="https://git-scm.com/download/mac">ce lien</a>.</p>
<p><br></p>
</section>
</section>
</section>
<section id="premiers-pas-avec-git" class="level1">
<h1>Premiers pas avec git</h1>
<p>Une fois git installé, ouvrez RStudio et <a href="https://ateliers-codons.netlify.app/posts/02-premiers-pas-avec-r/#créer-un-projet">créez un nouveau projet</a>. Cliquez sur <em>Tools &gt; Global Options &gt; Git/SVN</em>. Assurez-vous que la case <em>Enable version control interface for RStudio projects</em> est cochée, et que le chemin vers l’exécutable <em>git</em> est bien renseigné. Si ce n’est pas le cas, cliquez sur <em>Browse</em> et indiquez-le. Validez en cliquant sur <em>Apply</em>.</p>
<p><img src="img/git_05.png" class="img-fluid" style="width:50.0%"></p>
<p><br></p>
<section id="en-ligne-de-commande" class="level2">
<h2 class="anchored" data-anchor-id="en-ligne-de-commande">En ligne de commande</h2>
<p>Dans votre session RStudio, ouvrez un <em>terminal</em> :</p>
<p><img src="img/git_cmd_01.png" class="img-fluid" style="width:50.0%"></p>
<p><br> Tapez la ligne de commande suivante pour afficher la version de <em>git</em> installée sur votre ordinateur :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>git <span class="sc">--</span>version</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<section id="paramétrer-git" class="level3">
<h3 class="anchored" data-anchor-id="paramétrer-git">Paramétrer git</h3>
<p>Dans un premier temps, nous allons paramétrer <em>git</em> en renseignant un nom d’utilisateur et un e-mail qui seront utilisés pour nous identifier dans l’historique (cela nous permettra si nous travaillons à plusieurs sur un même projet de savoir qui a fait quoi). Dans la suite du turoriel nous verrons comment connecter RStudio à GitLab, nous allons donc utiliser nos identifiants LDAP :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>git config <span class="sc">--</span>global <span class="sc">--</span>user.name <span class="st">"prenom.nom"</span>  </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>git config <span class="sc">--</span>global <span class="sc">--</span>user.email prenom.nom<span class="sc">@</span>inrae.fr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Assurons-nous que ces paramètres ont bien été pris en compte :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>git config <span class="sc">--</span>global <span class="sc">--</span>list</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section>
<section id="initialiser-git" class="level3">
<h3 class="anchored" data-anchor-id="initialiser-git">Initialiser git</h3>
<p>Pour l’instant, notre répertoire de travail (le projet RStudio) n’est pas versionné. Il nous faut pour cela associer un répertoire git à notre répertoire de travail, en <strong>initialisant</strong> git :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>git init</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Assurons-nous que le répertoire <em>git</em> a bien été créé. La commande <code>ls</code> permet de lister les fichiers du répertoire actuel, et les options <code>-la</code> permettent d’afficher le détail (droits, date, …) et d’inclure les dossiers cachés (dont le nom commence par un point <code>.</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>ls <span class="sc">-</span>la</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ignorer-des-fichiers" class="level3">
<h3 class="anchored" data-anchor-id="ignorer-des-fichiers">Ignorer des fichiers</h3>
<p>Parmi les fichiers et répertoires listés ci-dessus, le répertoire <code>.Rproj.user</code> n’a pas besoin d’être versionné. Nous allons pour cela ajouter à notre répertoire de travail un fichier dans lequel nous pourrons lister les fichiers et répertoires que git devra ignorer. Créons un fichier texte basique en cliquant sur <em>File &gt; New File &gt; Text File</em>. Sauvegardons ce fichier à la racine de notre répertoire de travail en le nommant <code>.gitignore</code>. Ajoutons une ligne à ce fichier comme ci-dessous :</p>
<p><img src="img/git_cmd_10.png" class="img-fluid"></p>
<p><br></p>
<p>Vérifions l’état dans lequel notre répertoire se trouve :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>git status</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="img/git_cmd_02.png" class="img-fluid" style="width:50.0%"></p>
<p>Le terminal affiche plusieurs informations :</p>
<ul>
<li><p><em>On branch master</em> : nous nous trouvons sur la branche principale (et la seule pour le moment)</p></li>
<li><p><em>No commits yet</em> : nous n’avons pas encore figé l’état de notre répertoire à l’aide d’un commit</p></li>
<li><p><em>Untracked files</em> : des fichiers non versionnés sont présents dans le répertoire de travail</p></li>
<li><p><em>nothing added to commit but untracked files present</em> : redite de la ligne précédente</p></li>
<li><p><em>use “git add” to track</em> : pour figer l’état de ces fichiers et tracer l’historique des modifications, nous utiliserons la commande <code>git add</code>.</p></li>
</ul>
<p>Pour afficher également les fichiers ignorés, nous utilisons la commande <code>git status --ignored</code>.</p>
<p><br></p>
</section>
<section id="git-add" class="level3">
<h3 class="anchored" data-anchor-id="git-add">git add</h3>
<p>Ajoutons nos deux fichiers, soit en précisant leurs noms, soit en utilisant le symbole <code>*</code> (pour ajouter tous les fichiers présents dans notre répertoire de travail) ou encore un point <code>.</code> (pour ajouter le répertoire actuel) :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter les fichiers un a un</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>git add .gitignore tutoriel_git.Rproj</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter tous les fichiers du repertoire de travail</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>git add <span class="sc">*</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter le répertoire actuel</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>git add .</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Affichons l’état de notre répertoire à l’aide de la commande <code>git status</code>. Nous pouvons remarquer que les noms des fichiers ajoutés apparaissent en vert.</p>
<p>De nouvelles informations sont affichées dans le terminal :</p>
<ul>
<li><p><em>No commits yet</em> : les fichiers ont été ajoutés mais leur état n’a pas encore été figé par un commit</p></li>
<li><p><em>Changes to be commited</em> : liste des fichiers ajoutés mais pas encore figés</p></li>
</ul>
<p>Nous voyons également la commande à utiliser pour annuler l’ajout des fichiers :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Annuler l'ajout de fichiers un par un</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>git rm <span class="sc">--</span>cached .gitignore tutoriel_git.Rproj</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Annuler l'ajout de tous les fichiers du repertoire de travail</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>git rm <span class="sc">--</span>cached <span class="sc">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
rm -r
</div>
</div>
<div class="callout-body-container callout-body">
<p>L’argument <code>-r</code> permet de supprimer de façon récursive un dossier.</p>
</div>
</div>
<p><br></p>
</section>
<section id="git-commit" class="level3">
<h3 class="anchored" data-anchor-id="git-commit">git commit</h3>
<p>Nous allons maintenant figer l’état de notre répertoire de travail à l’aide de la commande <code>git commit -m ...</code>. Un commit est toujours associé à un message (<code>-m</code>) à écrire entre guillemets (<code>"message"</code>) pour préciser ce que nous faisons. Soyez le plus précis possible dans vos messages de commits, cela vous permettra de vous y retrouver dans l’historique des modifications !</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/git_commit_2x.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Dessin de <span class="citation" data-cites="xkcd">@xkcd</span></figcaption><p></p>
</figure>
</div>
<p><br></p>
<p>Nous effectuons le premier commit à l’aide de la commande suivante :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>git commit <span class="sc">-</span>m <span class="st">"premier commit"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="img/git_cmd_03.png" class="img-fluid"></p>
<p>Si nous tapons <code>git status</code> dans le terminal, celui-ci affiche <em>nothing to commit, working tree clean</em>. Cela indique que notre commit a bien été effectué.</p>
<p>La commande <code>git log</code> permet d’afficher l’historique de notre répertoire :</p>
<p><img src="img/git_cmd_04.png" class="img-fluid"></p>
<ul>
<li><p><em>commit ### (HEAD -&gt; master)</em> nous donne lidentifiant unique du commit et indique où pointe notre dernier commit (sur la branche master)</p></li>
<li><p><em>auteur</em> (avec les identifiants renseignés plus haut), <em>date</em> et <em>message</em> du commit</p></li>
</ul>
<p><br></p>
<p>Ajoutons un fichier README dans notre répertoire : <em>File &gt; New File &gt; Markdown File</em>. Ajoutons une ligne et sauvegardons le fichier à la racine de notre répertoire :</p>
<p><img src="img/git_md_01.png" class="img-fluid"></p>
<p>Nous allons ajouter ce fichier et effectuer un commit :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>git add README.md</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>git commit <span class="sc">-</span>m <span class="st">"ajout d'un fichier README.md"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Affichons l’historique de nos commits à l’aide de la commande <code>git log</code> :</p>
<p><img src="img/git_cmd_05.png" class="img-fluid"></p>
<p>Ajoutons une ligne de texte dans notre fichier <code>README.md</code> et sauvegardons-le :</p>
<p><img src="img/git_cmd_06.png" class="img-fluid"> Tapons les commandes suivantes :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>git add README.md</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>git commit <span class="sc">-</span>m <span class="st">"ajout d'une ligne de texte dans le fichier README.md"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br></p>
</section>
<section id="naviguer-dans-les-commits" class="level3">
<h3 class="anchored" data-anchor-id="naviguer-dans-les-commits">Naviguer dans les commits</h3>
<p>Affichons à nouveau l’historique avec <code>git log</code>.</p>
<p>Nous allons revenir au commit précédent dans notre historique. Pour cela, nous copions l’identifiant unique du commit auquel nous souhaitons revenir :</p>
<p><img src="img/git_cmd_07.png" class="img-fluid"></p>
<p>Dans le terminal, nous tapons la commande suivante (en collant l’identifiant du commit à la place de <em>commit_id</em>) :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>git checkout <span class="sc">&lt;</span>commit_id<span class="sc">&gt;</span> .</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-caution callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
git checkout <commit_id> .
</commit_id></div>
</div>
<div class="callout-body-container callout-body">
<p>N’oubliez pas le point à la fin de la ligne de commande !</p>
</div>
</div>
<p><br></p>
<p>Nous pouvons remarquer que dans notre fichier <code>README.md</code>, la ligne que nous avions ajoutée n’est plus visible : nous sommes revenus au commit précédent de notre historique.</p>
<p>Pour revenir au dernier commit effectué, nous pouvons procéder de la même façon en copiant l’identifiant du commit et en utilisant la commande <code>git checkout &lt;commit_id&gt; .</code>. Nous pouvons également utiliser la commande <code>git reset --hard HEAD</code>. Cette commande change l’emplacement et nous replace au niveau du commit le plus récent (imaginez que vos différents commits sont représentés pas des noeuds le long d’un segment).</p>
<p><br></p>
</section>
<section id="créer-une-branche" class="level3">
<h3 class="anchored" data-anchor-id="créer-une-branche">Créer une branche</h3>
<p>Les branches nous permettent de travailler sur nos fichiers sans impacter la branche principale qui contient notre répertoire “propre”.</p>
<p>Créons une branche que nous appelons “dev” : <code>git branch dev</code>.</p>
<p>Pour afficher les différentes branches, utilisons la commande <code>git branch</code> : <img src="img/git_cmd_11.png" class="img-fluid">.</p>
<p>L’astérisque indique la branche sur laquelle nous nous situons, pour l’instant la branche <em>master</em>.</p>
<p>Pour changer de branche, utilisons la commande <code>git switch &lt;nom-de-la-branche&gt;</code>. Exécutons les commandes suivantes :</p>
<p><img src="img/git_cmd_12.png" class="img-fluid"></p>
<p>Nous nous situons bien sur la branche <em>dev</em>.</p>
<p>Pour supprimer une branche, nous utilisons la commande <code>git branch -d &lt;nom-de-la-branche&gt;</code>. Avant de pouvoir supprimer la branche <em>dev</em>, il faut se placer sur la branche <em>master</em> :</p>
<p><img src="img/git_cmd_13.png" class="img-fluid"></p>
<p>La commande <code>git checkout -b &lt;nom-de-la-nouvelle-branche&gt;</code> permet de créer une branche et de s’y placer. Cette fonction permet également de changer de branche : <code>git checkout master</code> par exemple.</p>
<p>Nous pouvons créer une nouvelle branche à partir d’un commit précis, en précisant l’identifiant du commit : <code>git checkout -b &lt;nom-de-la-branche&gt; &lt;commit_id&gt;</code>.</p>
<p>Modifions le fichier README.md sur la branche dev :</p>
<p><img src="img/git_cmd_14.png" class="img-fluid"></p>
<p>Effectuons un <code>add + commit</code> sur cette branche dev :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>git add README.md</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>git commit <span class="sc">-</span>m <span class="st">"modification du fichier README.md sur la branche dev"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En naviguant entre les branches à l’aide de <code>git checkout</code> (ou <code>git switch</code>) pour afficher l’historique avec <code>git log</code>, nous remarquons que l’historique varie en fonction de la branche sur laquelle on se trouve.</p>
</section>
<section id="fusionner-les-branches-et-résoudre-les-conflits" class="level3">
<h3 class="anchored" data-anchor-id="fusionner-les-branches-et-résoudre-les-conflits">Fusionner les branches et résoudre les conflits</h3>
<p>Nous avons terminé de travailler sur la branche dev, nous aimerions maintenant rappatrier les modifications apportées sur cette branche sur notre branche principale, en “fusionnant” les deux branches.</p>
<p>Commençons par nous placer sur la branche <em>master</em> : <code>git checkout master</code></p>
<p>Pour fusionner la branche dev sur la branche master, nous utilisons la commande <code>git merge</code> :</p>
<p><img src="img/git_cmd_15.png" class="img-fluid"></p>
<p>Le terminal nous indique qu’il y a un conflit : le fichier README.md diffère entre les deux branches, et nous sommes invités à résoudre ce conflit avant de fusionner les branches.</p>
<p>Regardons à quoi ressemble notre fichier README.md :</p>
<p><img src="img/git_cmd_16.png" class="img-fluid"></p>
<ul>
<li><p>Les marqueurs de conflit indiquent le début (<code>&lt;&lt;&lt;&lt;</code>) et la fin (<code>&gt;&gt;&gt;</code>) du conflit</p></li>
<li><p>Les noms des branches sont indiqués à côté de ces marqueurs de conflit</p></li>
<li><p>L’indicateur <code>=====</code> montre la séparation entre les modifications des deux branches<br>
Il nous incombe de choisir quelle version conservée : nous allons supprimer les indicateurs <code>&lt;&lt;&lt;</code>, <code>&gt;&gt;&gt;</code> et <code>===</code> et ne garder que le texte présent dans le fichier de la branche <em>dev</em>.</p></li>
</ul>
<p>Vérifions l’état de notre branche <em>master</em> à l’aide de la commande <code>git status</code> :</p>
<p><img src="img/git_cmd_17.png" class="img-fluid"></p>
<p>Les deux branches ne sont pas fusionnées, mais les modifications ont bien été prises en compte.</p>
<p>Ajoutons le fichier <code>README.md</code> et effectuons un commit :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>git add README.md</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>git commit <span class="sc">-</span>m <span class="st">"resolution de conflit entre les branches master et dev"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En affichant l’historique avec <code>git log</code> nous voyons maintenant l’ensemble des commits effectués sur les deux branches.</p>
<p><img src="img/git_cmd_18.png" class="img-fluid"></p>
<p>Nous pouvons maintenant supprimer la branche <em>dev</em> : <code>git branch -d dev</code></p>
</section>
</section>
<section id="en-clique-bouton" class="level2">
<h2 class="anchored" data-anchor-id="en-clique-bouton">En “clique-bouton”</h2>
<section id="initialiser-git-1" class="level3">
<h3 class="anchored" data-anchor-id="initialiser-git-1">Initialiser git</h3>
<p>Créons un nouveau RStudio pour refaire ce que nous avons fait en ligne de commande, mais cette fois-ci à l’aide de l’interface graphique de RStudio.</p>
<p>Pour initialiser git, cliquons sur <em>Tools &gt; Project Options</em>, puis dans le menu <em>Git/SVN</em> sélectionnons <em>Git</em> :</p>
<p><img src="img/git_ide_01.png" class="img-fluid"></p>
<p>Dans les fenêtres qui s’ouvrent, cliquons sur <em>Yes</em>.</p>
<p>RStudio redémarre, et nous pouvons remarquer la présence d’un onglet <em>Git</em> dans notre espace de travail. En cliquant dessus, nous pouvons voir qu’un fichier <code>.gitignore</code> a été ajouté automatiquement :</p>
<p><img src="img/git_ide_02.png" class="img-fluid"><br>
<img src="img/git_ide_03.png" class="img-fluid"></p>
<p><br></p>
</section>
<section id="ajouter-des-fichiers" class="level3">
<h3 class="anchored" data-anchor-id="ajouter-des-fichiers">Ajouter des fichiers</h3>
<p>Pour ajouter des fichiers (ce que nous avons fait avec <code>git add</code>), cochez-les dans l’onglet git. Leur statut passe de <em>??</em> à <em>A</em> (pour Added).</p>
<p><img src="img/git_ordi_vide_01.png" class="img-fluid"></p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Sélectionner plusieurs fichiers
</div>
</div>
<div class="callout-body-container callout-body">
<p>Quand nous travaillons avec beaucoup de fichiers versionnés, nous pouvons tous les sélectionner : cliquons sur le nom d’un des fichiers dans l’onglet git, puis utilisons la combinaison <em>Ctrl + A</em> et enfin cochons la case à côté du premier fichier sur lequel nous avions cliqué.</p>
</div>
</div>
<p>Nous allons maintenant effectuer un <em>commit</em> (<code>git commit -m</code>) : cliquons sur <em>Commit</em>. Dans la fenêtre qui s’ouvre, nous allons écrire le message du commit (ce que nous mettions après <code>-m</code>) et cliquons à nouveau sur <em>Commit</em>.</p>
<p><img src="img/git_ordi_vide_02.png" class="img-fluid"> En cliquant sur l’icône <em>horloge</em> nous pouvons voir l’historique de nos commits.</p>
<p><img src="img/git_ordi_vide_03.png" class="img-fluid"></p>
</section>
<section id="créer-une-branche-1" class="level3">
<h3 class="anchored" data-anchor-id="créer-une-branche-1">Créer une branche</h3>
<p>Nous pouvons créer une nouvelle branche en cliquant sur l’icône à gauche du nom de la branche actuelle, en précisant le nom et en cliquant sur <em>Create</em> :</p>
<p><img src="img/git_ordi_vide_04.png" class="img-fluid"></p>
<p>Nous pouvons maintenant naviguer entre les branches directement en cliquant sur leurs noms :</p>
<p><img src="img/git_ordi_vide_05.png" class="img-fluid"></p>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Limites de l’approche clique-bouton
</div>
</div>
<div class="callout-body-container callout-body">
<p>Nous ne pourrons pas revenir à un commit précédent, créer une branche à partir d’un commit précis ou résoudre des conflits lors de la fusion de branches dans l’onglet <em>Git</em> de RStudio. Il nous faudra utiliser la ligne de commande.</p>
</div>
</div>
<p><br></p>
</section>
<section id="paramétrer-rstudio" class="level3">
<h3 class="anchored" data-anchor-id="paramétrer-rstudio">Paramétrer RStudio</h3>
<p>Ouvrez une session dans RStudio, puis cliquez sur <em>Tools</em> &gt; <em>Global Options</em> &gt; <em>Git/SVN</em>.</p>
<p><img src="img/git_06.png" class="img-fluid" style="width:50.0%"></p>
<ol type="1">
<li><p>Assurez-vous que la case <em>Enable version control interface for RStudio projects</em> est cochée.</p></li>
<li><p>Assurez-vous que le chemin vers l’exécutable <code>git</code> est bien renseigné. Le cas échéant, cliquez sur <em>Browse</em> et indiquez le chemin vers son emplacement.</p></li>
<li><p>Si aucune clé SSH n’est indiquée, cliquez sur <em>Create RSA Key…</em>.</p></li>
<li><p>Validez en cliquant sur <em>Apply</em>.</p></li>
</ol>
<p><br></p>
<p>Cliquez sur <em>View public key</em> et copiez la clé qui s’affiche.</p>
</section>
<section id="paramétrer-gitlab" class="level3">
<h3 class="anchored" data-anchor-id="paramétrer-gitlab">Paramétrer GitLab</h3>
<p>Ouvrez <a href="https://forgemia.inra.fr">ce lien</a> dans votre navigateur internet et cliquez sur <em>Connexion SSO</em>.</p>
<p><img src="img/git_07.png" class="img-fluid" style="width:50.0%"></p>
<p>Dans le menu déroulant, choisissez <em>INRAE</em> et cliquez sur <em>Sélectionner</em>. Dans le menu suivant, renseignez les champs à l’aide de votre identifiant LDAP puis cliquez sur <em>Se connecter</em>.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_08.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_09.png" class="img-fluid"></p>
</div>
</div>
</div>
<p><br></p>
<p>Cliquez sur l’icône dans le coin supérieur droit puis sur <em>Preferences</em>.</p>
<p><img src="img/git_10.png" class="img-fluid" style="width:50.0%"></p>
<p>Dans la barre de menu à gauche, cliquez sur la première icône en forme de clé. Collez dans le champ <em>Key</em> la clé SSH copiée dans RStudio. Le champ <em>Title</em> devrait se remplir automatiquement. Si ce n’est pas le cas, renseignez ce champ. Vous pouvez choisir une date d’expiration de votre clé dans <em>Expiration date</em>. Pour terminer, cliquez sur <em>Add key</em>. Assurez-vous que votre clé apparaisse bien en base de la page sous <em>Your SSH keys</em>.</p>
<p><img src="img/git_11.png" class="img-fluid"></p>
</section>
</section>
</section>
<section id="de-gitlab-vers-rstudio" class="level1">
<h1>De GitLab vers RStudio</h1>
<section id="dans-gitlab" class="level2">
<h2 class="anchored" data-anchor-id="dans-gitlab">Dans GitLab</h2>
<p>Dans la barre de menu supérieure, cliquez sur l’icône <em>plus</em> et sélectionnez <em>New project/repository</em>. Dans le menu suivant, choisissez <em>Create blank project</em>.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_12.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_13.png" class="img-fluid"></p>
</div>
</div>
</div>
<p><br></p>
<p>Dans le menu <em>Create blank project</em>, remplissez les différents champs :</p>
<ul>
<li><p><em>Project name</em> : nom du projet (avec les mêmes conventions d’écriture que si vous étiez en train de <a href="https://ateliers-codons.netlify.app/posts/02-premiers-pas-avec-r/#cr%C3%A9er-un-projet">créer un projet dans RStudio</a>).</p></li>
<li><p><em>Project URL</em> : en fonction des groupes dont vous faites partie, vous pourrez choisir l’emplacement du projet. Pour l’instant, choisissez votre espace utilisateur.</p></li>
<li><p><em>Project slug</em> : identique au nom du projet.</p></li>
<li><p><em>Visibility Level</em> : qui a accès au projet. Pour notre exemple, choisissez <em>Public</em>.</p></li>
<li><p><em>Project Configuration</em> : cochez la case <em>Initialize repository with a README</em>.</p></li>
</ul>
<p>Cliquez sur <em>Create project</em>. Le projet s’ouvre et vous pouvez voir qu’il contient un ficher <code>README.md</code>. Ce fichier s’affiche sur la page d’accueil de votre projet et contient par défaut des informations sur l’utilisation de GitLab.</p>
<p><img src="img/git_15.png" class="img-fluid"></p>
<p><br></p>
<p>Nous allons maintenant “rapatrier” ce projet sur notre ordinateur. Pour cela, cliquez sur l’onglet <em>Clone</em> et choisissez <em>Clone with SSH</em>. Cliquez sur <em>Copy URL</em>.</p>
<p><img src="img/git_16.png" class="img-fluid"></p>
</section>
<section id="dans-rstudio" class="level2">
<h2 class="anchored" data-anchor-id="dans-rstudio">Dans RStudio</h2>
<p>Dans la barre de menu supérieure, cliquez sur <em>File</em> &gt; <em>New project</em>.<br>
Dans la fenêtre <em>Create Project</em>, choisissez <em>Version Control</em>.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_17.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_18.png" class="img-fluid"></p>
</div>
</div>
</div>
<p>Dans la fenêtre <em>Create Project from Version Control</em>, choisissez <em>Git</em>.</p>
<p>Dans la fenêtre <em>Clone Git Repository</em>, remplissez les champs : - <em>Repository URL</em> : collez le lien SSH copié dans GitLab<br>
- <em>Project directory name</em> : se remplit automatiquement<br>
- <em>Create project as subdirectory of</em> : emplacement où sera créé le projet</p>
<p>Cochez la case <em>Open in New Session</em> dans le coin inféreur gauche de la fenêtre et cliquez sur <em>Create Project</em>.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_19.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_20.png" class="img-fluid"></p>
</div>
</div>
</div>
<p>Une nouvelle fenêtre RStudio s’ouvre. Vous remarquerez la présence d’un onglet <em>Git</em> dans votre espace de travail.</p>
</section>
<section id="workflow" class="level2">
<h2 class="anchored" data-anchor-id="workflow">Workflow</h2>
<p>Dans votre espace de travail, sous l’onglet <em>git</em>, deux fichiers sont présents :</p>
<ul>
<li><code>.gitignore</code><br>
</li>
<li><code>test_gitlab_rstudio.Rproj</code></li>
</ul>
<p>Ces fichiers ont été ajoutés dans votre répertoire de travail lors de la création du projet dans RStudio, mais ils ne sont pas présents dans votre répertoire sur GitLab. L’icône <code>?</code> indique qu’il s’agit de nouveaux fichiers.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Le statut des fichiers
</div>
</div>
<div class="callout-body-container callout-body">
<p>L’icône à gauche du nom d’un fichier dans l’onglet <em>git</em> de votre espace de travail indique le statut de ce fichier :</p>
<table class="table">
<tbody>
<tr class="odd">
<td><img src="img/git_22.png" class="img-fluid"></td>
<td>nouveau fichier</td>
</tr>
<tr class="even">
<td><img src="img/git_23.png" class="img-fluid"></td>
<td>fichier ajouté</td>
</tr>
<tr class="odd">
<td><img src="img/git_29.png" class="img-fluid"></td>
<td>fichier modifié</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Le workflow git permet de synchroniser le répertoire distant (sur GitLab) avec le répertoire local (notre projet RStudio). Il comprend trois étapes :</p>
<section id="commit" class="level3">
<h3 class="anchored" data-anchor-id="commit">Commit</h3>
<p>Nous allons sauvegarder les modifications apportées à nos fichiers (que ce soit des modifications dans un fichier, l’ajout ou la suppression de fichiers). Nous cochons pour cela les cases à gauche des icônes de statut, qui deviennent un <code>A</code> vert. Les deux fichiers sont maintenant prêts à être mis en ligne dans notre répertoire sur GitLab. C’est la première étape du workflow git, qu’on appelle un <em>commit</em>.</p>
<p>Cliquez sur <em>Commit</em> et ajoutez un commentaire dans la fenêtre qui s’ouvre.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_24.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_25.png" class="img-fluid"></p>
</div>
</div>
</div>
<p>Cliquez ensuite sur <em>Commit</em> : un résumé de votre soumission s’affiche. Fermez cette fenêtre en cliquant sur <em>Close</em>.</p>
<p><img src="img/git_26.png" class="img-fluid"></p>
<p>Dans la fenêtre <em>RStudio: Review Changes</em>, vous pouvez lire <em>Your branch is ahead of ‘origin/main’ by 1 commit’</em>. Cela indique que votre branche locale est en avance d’une étape sur la branche distance sur GitLab.</p>
</section>
<section id="pull" class="level3">
<h3 class="anchored" data-anchor-id="pull">Pull</h3>
<p>Cela peut paraître contre-intuitif, mais il est important de nous assurer que notre répertoire local contient bien les dernières modifications sauvegardées dans notre répertoire distant. Pour cela, nous cliquons sur <em>Pull</em>.</p>
</section>
<section id="push" class="level3">
<h3 class="anchored" data-anchor-id="push">Push</h3>
<p>Il nous reste à <em>pousser</em> nos modifications locales vers le répertoire distant en cliquant sur <em>Push</em>.</p>
<p><img src="img/git_27.png" class="img-fluid"> Assurons-nous que nos modifications ont bien été exportées en rafraîchissant notre page GitLab.</p>
<p><img src="img/git_28.png" class="img-fluid"></p>
<p><br></p>
<p>Nous allons modifier le fichier <code>README.md</code> : ouvrons-le en cliquant dessus dans le panneau de navigation. Le fichier s’ouvre dans le panneau <em>scripts</em>. Remplaçons le texte par la ligne suivante :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Connecter RStudio à GitLab</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sauvegardons le fichier (<strong>Ctrl + S</strong> ou icône disquette) : le fichier apparaît dans l’onglet <em>git</em> de notre espace de travail avec une icône <code>M</code> bleue, indiquant qu’il a été modifié.</p>
<p>Nous allons effectuer les mêmes opérations que ci-dessus pour exporter nos modifications vers la branche distante du répertoire sur GitLab : <em>Commit</em> &gt; <em>Pull</em> &gt; <em>Push</em>.</p>
<p><br></p>
</section>
</section>
<section id="historique-des-modifications" class="level2">
<h2 class="anchored" data-anchor-id="historique-des-modifications">Historique des modifications</h2>
<p>Travailler avec un suivi de version permet de retracer toutes les modifications apportées aux fichiers d’un répertoire.</p>
<section id="dans-rstudio-1" class="level3">
<h3 class="anchored" data-anchor-id="dans-rstudio-1">Dans RStudio</h3>
<p>Cliquez sur l’icône horloge dans l’onglet <code>Git</code></p>
<p><img src="img/git_30.png" class="img-fluid"></p>
<p>L’hitorique contient toutes les mofications apportées, ainsi qu’une clé <em>SHA</em>, encore appelée <em>commit hash</em>. Il s’agit d’un identifiant unique attribué par Git à chacun des commits.</p>
</section>
<section id="dans-gitlab-1" class="level3">
<h3 class="anchored" data-anchor-id="dans-gitlab-1">Dans GitLab</h3>
<p>Sur la page d’accueil de votre répertoire disant sur GitLab, cliquez sur <em>3 Commits</em> pour accéder à l’historique des modifications.</p>
<p><img src="img/git_31.png" class="img-fluid"></p>
<p>Vous retrouverez les clés SHA à droite des commits listés dans l’historique, ainsi que deux icônes vous permettant de :</p>
<ul>
<li><p>copier la clé SHA du commit</p></li>
<li><p>ouvrir l’arborescence correspond au commit</p></li>
</ul>
</section>
</section>
</section>
<section id="de-rstudio-vers-gitlab" class="level1">
<h1>De RStudio vers GitLab</h1>
<p>Nous avons jusqu’ici vu comment utiliser le suivi de version en partant d’un nouveau répertoire sur GitLab.</p>
<section id="dans-rstudio-2" class="level2">
<h2 class="anchored" data-anchor-id="dans-rstudio-2">Dans RStudio</h2>
<p>Si nous souhaitons utiliser le suivi de version pour un répertoire présent sur notre ordinateur, deux cas de figure se présentent :</p>
<section id="répertoire-associé-à-un-projet-rstudio" class="level3">
<h3 class="anchored" data-anchor-id="répertoire-associé-à-un-projet-rstudio">Répertoire associé à un projet RStudio</h3>
<p>Si votre répertoire est déjà associé à un projet RStudio, ouvrez ce projet. Dans notre exemple, nous utilisons le projet <em>ateliers_codons</em> créés dans <a href="https://ateliers-codons.netlify.app/posts/02-premiers-pas-avec-r/#cr%C3%A9er-un-projet">ce tutoriel</a>.</p>
<p>Cliquez sur <em>Tools</em> &gt; <em>Project Options</em> &gt; <em>Git/SVN</em>.</p>
<p>Dans la fenêtre <em>Project Options</em>, choisissez <em>Git</em> dans le menu déroulant <em>Version control system</em>.</p>
<p>Dans la fenêtre qui s’ouvre, cliquez sur <em>Yes</em> en réponse à la question <em>Do you want to initialize a new git repository for this project?</em>.</p>
<p>Dans la fenêtre <em>Restart RStudio</em>, cliquez sur <em>Yes</em>.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_34.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_35.png" class="img-fluid"></p>
</div>
</div>
</div>
<p>RStudio redémarre et vous remarquerez l’onglet <code>Git</code> dans l’espace de travail de votre projet.</p>
</section>
</section>
<section id="dans-gitlab-2" class="level2">
<h2 class="anchored" data-anchor-id="dans-gitlab-2">Dans GitLab</h2>
<p>Créez un nouveau projet dans GitLab, portant le même nom que le projet RStudio pour lequel vous souhaitez utiliser le suivi de version.</p>
<p>Faites attention à décocher la case <em>Initialize repository with a README</em>.</p>
</section>
<section id="dans-rstudio-3" class="level2">
<h2 class="anchored" data-anchor-id="dans-rstudio-3">Dans RStudio</h2>
<p>Nous allons utiliser les lignes de commandes affichées sur la page d’accueil de notre projet GitLab : <img src="img/git_40.png" class="img-fluid"></p>
<p>Ouvrez un terminal dans l’onglet <code>Git</code> en cliquant sur la roue crantée puis sur <em>Shell</em>.</p>
<p>Dans l’onglet <code>git</code>, sélectionnez l’ensemble des fichiers à ajouter.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Ajouter plusieurs fichiers
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pour éviter d’avoir à cocher de nombres cases, vous pouvez cliquer sur le nom du premier fichier de la liste, puis utiliser la combinaison <strong>Ctrl + A</strong>. Cochez ensuite la case en face du premier fichier.</p>
</div>
</div>
<p>Cliquez sur <em>Commit</em>, ajoutez un commentaire dans la fenêtre qui s’ouvre et cliquez sur <em>Commit</em>. Pour l’instant, vous n’avez pas accès aux boutons <em>Pull</em> et <em>Push</em>.</p>
<p>Cliquez sur l’icône à droite du panneau <code>Git</code> :</p>
<p><img src="img/git_36.png" class="img-fluid"></p>
<p>Dans le fenêtre qui s’ouvre, cliquez sur <em>Add Remote</em>, puis renseignez les deux champs dans la fenêtre :</p>
<ul>
<li><p><em>Remote Name</em> -&gt; “origin”</p></li>
<li><p><em>Remote URL</em> -&gt; collez le lien SSH copié dans GitLab</p></li>
</ul>
<p>Cliquez ensuite sur <em>Add</em>.</p>
<p><img src="img/git_37.png" class="img-fluid"></p>
<p>Dans la fenêtre <em>New Branch</em>, indiquez “master” dans le champ <em>Branch Name</em>, et assurez-vous que la case <em>Sync branch with remote</em> est bien cochée. Cliquez sur <em>Create</em>. Dans la fenêtre <em>Local Branch Already Exists</em>, cliquez sur <em>Overwrite</em>.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_38.png" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="img/git_39.png" class="img-fluid"></p>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>