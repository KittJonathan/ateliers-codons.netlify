{
  "hash": "b14e60865a8b98647c1e8b27f19b26a0",
  "result": {
    "markdown": "---\ntitle: \"Premiers pas avec R\"\nsubtitle: \"Se familiariser avec R, manipuler des données et les représenter\"\nauthor:\n  - Gergana Daskalova\n  - Jonathan Kitt (adaptation)\ndate: \"2022-10-13\"\ncategories: [R, RStudio, bases]\nformat: \n  html: \n    page-layout: full\n    toc: true\n    toc-depth: 2\n    toc-title: \"Sommaire\"\n---\n\n::: {.cell}\n\n:::\n\n\n*Ce tutoriel est adapté de [Getting started with R and RStudio](https://ourcodingclub.github.io/tutorials/intro-to-r/) du site [Our Coding Club](https://ourcodingclub.github.io/).*\n\n<br>\n\n::: {.callout-tip icon=\"false\"}\n## Objectifs du tutoriel\n\n- Se familiariser avec RStudio  \n- Organiser son travail  \n- Utiliser un script  \n- Importer, explorer, manipuler et représenter des données\n\n:::\n\n\n::: {.callout-note icon=\"true\"}\n## Note\n\nPour savoir comment installer R et RStudio, cliquez [ici](https://ateliers-codons.netlify.app/posts/01-installer-r-et-rstudio/)\n:::\n\n<br>\n\n# Introduction {#r_intro}\n\n## Qu'est-ce que R ? {#r_def}\n\n<br>\n\nR est un **langage de programmation statistique** qui a rapidement gagné en popularité dans de nombreux domaines scientifiques.\n\nIl a été développé par **Ross Ihaka** et **Robert Gentleman**, du Département de Statistiques de l'Université d'Auckland, comme **implémentation libre du langage de programmation S**.\n\n<br>\n\n::: {.callout-tip icon=\"true\"}\n## Quelques dates\n\n|      |                         |\n|------|-------------------------|\n| 1991 | Création du langage R   |\n| 1993 | R est dévoilé au public |\n| 1996 | [Article dans le *Journal of Computational and Graphical Statistics*](https://www.stat.auckland.ac.nz/~ihaka/downloads/R-paper.pdf) |\n:::\n\n<br>\n\nR désigne également le **logiciel** qui utilise ce langage pour des calculs statistiques (et tout un tas d'autres applications (manipulation de données, graphiques, ...).\n\nIl dispose d'une **communauté** en ligne très active ainsi que d'**extensions** pour presque tous les domaines et applications possibles et imaginables (cartographie, fouille de texte, modélisation, ...).\n\nContrairement à d'autres logiciels de statistiques comme Minitab ou SPSS, R peut être exécuté entièrement en **ligne de commande** et ne nécessite pas d'interface graphique, ce qui lui confère une **grande flexibilité**.\n\n<br>\n\n::: {.callout-tip icon=\"true\"}\n## Quelques avantages de R\n\n-   C'est un outil **libre et open source** (tout le monde peut utiliser le code et voir comment il fonctionne) \n\n-   C'est un langage de programmation plutôt qu'une interface graphique, ce qui permet à l'utilisateur de sauvegarder facilement des **scripts** sous forme de texte pour les ré-utiliser ou les partager\n\n-   Beaucoup de personnes l'utilisent dans beaucoup de domaines différents - **il est rare d'être confronté à un problème qui n'a jamais été résolu !**\n:::\n\n<br>\n\n## Naviguer dans RStudio {#naviguer_rstudio}\n\n<br>\n\nLa plupart des utilisateurs interagissent avec R à l'aide d'une **interface graphique**, dont la plus connue est RStudio.\n\nEn ouvrant RStudio, vous verrez une fenêtre comme celle ci-dessous, divisée en **trois panneaux** :\n\n![](img/rstudio_01.png){width=\"100%\"}\n\n<br>\n\n### La console\n\n<br>\n\nVous pouvez y **taper du code et l'exécuter** en appuyant sur `Entrée`.\n\nQuand vous démarrez une nouvelle session dans RStudio, la console affiche également des informations comme la version de R présente sur votre ordinateur ainsi que des indications sur la manière d'obtenir de l'aide.\n\n<br>\n\n::: {.callout-tip icon=\"true\"}\n## L'invite de commande\n\nDans la console, une ligne commence par `>` : c'est ce qu'on appelle l'**invite de commande**. Cela indique que R est prêt à recevoir vos instructions !\n\nTapez `2+2` puis appuyez sur `Entrée` : la console affiche le résultat.\n\n::: {.cell}\n\n```{.r .cell-code}\n2 + 2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4\n```\n:::\n:::\n\n\nDans la console, vous pouvez parcourir les **dernières commandes exécutées** à l'aide des flèches haut et bas.\n\n:::\n\n<br>\n\n### L'espace de travail\n\n<br>\n\nVous y trouverez votre **environnement** (données importées, objets créés, fonctions définies, ...), ainsi que d'autres onglets comme l'**historique** des commandes exécutées ou l'accès à des **tutoriels** (pour les versions récentes de RStudio).\n\n<br>\n\n::: {.callout-tip icon=\"true\"}\n## Un langage orienté objet\n\nR est un langage orienté objet, ce qui veut dire que tout ce que vous manipulez dans R est **stocké dans un objet**.\n:::\n\n<br>\n\nLorsque vous quittez votre session RStudio, vous aurez la possibilité de sauvegarder votre espace de travail. Il est préférable de ne pas le faire afin de démarrer chaque session avec un espace de travail vide.\n\n<br>\n\n### Le navigateur\n\n<br>\n\nCe navigateur vous permet de naviguer dans vos dossiers, de copier, renommer ou supprimer des fichiers, à la manière d'un explorateur classique.\n\nLes autres onglets permettent de visualiser les graphiques, de voir quels packages (extensions) sont installés, ou encore d'afficher l'aide.\n\n<br>\n\n### Le script\n\n<br>\n\n::: {.callout-important icon=\"true\"}\n## Important\n\nLe code tapé et exécuté dans la console ne sera plus disponible quand vous quitterez votre session RStudio. A la manière d'un document Word, un script vous permet de **sauvegarder votre code** afin d'y accéder ultérieurement ou de le partager.\n:::\n\n<br>\n\nPour ouvrir un nouveau script, cliquez sur le *\"plus\"* dans le coin supérieur gauche de la fenêtre RStudio puis sur *R Script*.\n\n![](img/rstudio_09.png){width=\"75%\"}\n\n<br>\n\n::: {.callout-tip icon=\"true\"}\n## Raccourcis clavier : ouvrir un nouveau script\n\nPour ouvrir un nouveau script, utilisez la combinaison **Ctrl + Shift + N**\n:::\n\n<br>\n\nUn nouveau panneau s'affiche :\n\n![](img/rstudio_10.png){width=\"100%\"}\n\n<br>\n\n# Organiser son travail\n\n## Créer un projet\n\n<br>\n\nLorsque vous partagez votre code avec d'autres personnes, celles-ci doivent pouvoir faire tourner vos analyses sans erreur et obtenir des résultats identiques (on parle de **reproductibilité**). \n\nLes **projets RStudio** aident à construire une analyse reproductible en regroupant tous les éléments nécessaires dans un seul dossier (code, données, figures et paramètres). Cela vous évitera de perdre du temps à chercher des fichiers dans votre ordinateur : la racine du projet est votre répertoire de travail. \n\nNous verrons dans un autre tutoriel comment connecter un projet RStudio à un gestionnaire de version comme GitLab : vous pourrez travailler à plusieurs sur un même code en gardant une trace de toutes les modifications apportées par l'une ou l'autre personne.\n\nPour créer un projet, cliquez sur *File* puis *New project...* :\n\n![](img/rstudio_02.png){width=\"75%\"}\n\n<br>\n\nChoisissez *New Directory* puis *New Project*\n\n::: {layout-ncol=2}\n\n![](img/rstudio_03.png){}\n\n![](img/rstudio_04.png){}\n:::\n\n<br>\n\nDans la fenêtre *Create New Project*, attribuez un nom et un emplacement au projet, puis cliquez sur *Create project*.\n\n![](img/rstudio_05.png){width=\"75%\"}\n\n<br>\n\nQuand vous voudrez travailler à nouveau sur ces données, il vous suffira d'ouvrir le projet en double-cliquant sur le fichier `.Rproj`.\n\n![](img/rstudio_06.png){width=\"75%\"}\n\n<br>\n\n::: {.callout-caution icon=\"true\"}\n## Bonnes pratiques : nommer ses fichiers et dossiers\n\n-   privilégiez les noms courts et explicites (à éviter : *fichier_2e_version_a\\_verifier.txt*)\n-   ne mettez ni espace ni caractères spéciaux (accents, symboles, ...)\\\n-   pour les dates, privilégiez le format **AAAAMMJJ** (année, mois, jour)\n-   mettez l'élément le plus important en premier (par exemple : *projet_date_contenu*)\\\n-   optez pour l'une de ces deux conventions d'écriture : **camel case** (*MonProjet*) ou **snake case** (*mon_projet*)\n\n:::\n\n<br>\n\n## Créer une arborescence\n\nIl est toujours préférable de passer un peu de temps à bien organiser un projet lors de sa création, plutôt que de passer beaucoup de temps par la suite à déplacer des fichiers, les renommer, les rechercher, ...\n\nPour créer un nouveau dossier dans votre projet, cliquez sur *New Folder* dans l'onglet *Files* du navigateur : \n\n![](img/rstudio_07.png){width=\"100%\"}\n\nL'organisation proposée ci-dessous est utilisable dans une très grande majorité de cas :\n\n- **raw** : données brutes\n\n- **data** : données issues de la manipulation/modification des données brutes\n\n- **scripts** : code utilisé pour analyser les données, créer les graphiques, ...\n\n- **results** : fichiers de résultats obtenus durant l'analyse\n\n- **figures** : graphiques générés au cours de l'analyse\n\n- **docs** : rapports, présentations, articles en lien avec l'analyse, documents concernant les outils utilisés, ... |\n\n![](img/rstudio_08.png){width=\"100%\"}\n\n<br>\n\n# Importer des données\n\n<br>\n\nLe jeu de données que nous allons utiliser contient des mesures pour [trois espèces de pingouins vivant sur l'archipel Palmer en Antarctique](https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0090081).\n\nToute opération réalisée dans R, que ce soit importer ou exporter des données, effectuer des calculs ou encore créer des graphiques, fait appel à une fonction. Une fonction est constituée de code et permet d'exécuter une action.\n\nLa manière dont la fonction s'exécute peut se modifier à l'aide d'arguments (obligatoires ou optionnels).\n\nPour importer les données, nous utilisons la fonction `read.csv()` en précisant deux arguments : \n\n- le chemin vers l'emplacement du fichier à importer entre guillemets  \n- l'argument `check.names = FALSE` pour conserver les noms de colonnes tels quels.  \n\nTapez le code ci-dessous dans votre script puis cliquez sur *Run*\n\n![](img/rstudio_29.png)\n\n<br>\n\n::: {.callout-caution icon=\"true\"}\n## Bonnes pratiques : auto-complétion\n\nR vous aide à compléter votre code : tapez `re` puis **Tab**, et vous verrez s'afficher une liste de fonctions ou d'objets commençant par ces deux lettres. Vous pouvez naviguer à l'aide des flèches haut et bas et valider votre choix en appuyant à nouveau sur **Tab**. Cette fonctionnalité de R est particulièrement utile lorsque vous manipulez des fichiers ou objets ayant des noms complexes.\n:::\n\n<br>\n\nDans la console, le code s'exécute et les données sont affichées. Cela indique que la commande a bien fonctionné, mais que les données ne sont pour l'instant pas disponibles dans notre environnement. Nous allons donc importer les données et les stocker dans un objet que nous appelons *pingouins*. Pour cela nous utilisons la **flèche d'assignation `<-`**. \n\n::: {.callout-tip icon=\"true\"}\n## Raccourcis clavier : flèche d'assignation\n\nPour insérer une flèche d'assignation, utilisez la combinaison **Alt + \"-\"** (tiret du 6).\n:::\n\n<br>\n\nTapez le code ci-dessous dans votre script puis cliquez sur *Run* : \n\n\n::: {.cell}\n\n```{.r .cell-code}\npingouins <- read.csv(\"raw/pingouins.csv\", check.names = FALSE)\n```\n:::\n\n\n::: {.callout-tip icon=\"true\"}\n## Raccourcis clavier : exécuter du code\n\nPour exécuter une ou plusieurs lignes de code, sélectionnez les lignes et utilisez la combinaison **Ctrl + Entrée**\n:::\n\n<br>\n\nVous pouvez également importer des données en cliquant sur *Import Dataset* puis sur *From Text (base)...* dans le panneau *Environnement* : \n\n![](img/rstudio_31.png){width=\"75%\"}\n\n<br>\n\nChoisissez le fichier à importer. La fenêtre qui s'ouvre vous permet de vérifier que les données seront correctement importées (présence d'un en-tête, séparateur de colonnes, ...) : \n\n![](img/rstudio_32.png){width=\"75%\"}\n\n<br>\n\nLa commande utilisée pour importer les données s'affiche dans la console. En procédant ainsi, R utilise le chemin absolu vers le fichier (à partir de la racine du disque dur), alors que nous avions utilisé le chemin relatif (à partir du répertoire de travail) à l'intérieur de la fonction `read.csv()`.\n\n<br>\n\nNotre environnement contient maintenant un objet **pingouins**, et vous pouvez voir l'indication `344 obs. of 9 variables` : le jeu de données contient 344 observations (lignes) et 9 variables (colonnes).\n\n![](img/rstudio_12.png){width=\"100%\"}\n\n<br>\n\nEn cliquant sur la flèche bleue à gauche du nom de l'objet, vous aurez accès à plus d'informations :\n\n![](img/rstudio_13.png){width=\"100%\"}\n\n<br>\n\n- les **noms** des variables, précédés du signe `$`  \n\n- le **type** de chaque varible : caractère (chr), nombres entiers (int) ou décimaux (int), logique (log)  \n\n- les **premiers éléments** de chaque variable\n\n\n::: {.callout-tip icon=\"true\"}\n## L'opérateur **\\$**\n\nCet opérateur permet de sélectionner la colonne d'un tableau. Dans la console, tapez `pingouins$` et appuyez sur **Tab**.\n\n![](img/rstudio_15.png){width=\"50%\"} \n\nVous pouvez choisir la variable qui vous intéresse à l'aide des **flèches haut et bas** (*Espece* par exemple) puis appuyer à nouveau sur **Tab** pour valider. Vous verrez alors s'afficher les 344 observations de cette variable. \n\n![](img/rstudio_16.png){width=\"75%\"}\n:::\n\n<br>\n\nVous pouvez afficher le tableau en cliquant sur l'icône à droite du nom de l'objet dans l'environnement.\n\n![](img/rstudio_14.png){width=\"100%\"}\n\nCela ouvre un nouvel onglet à côté de votre script :\n\n\n![](img/rstudio_17.png){width=\"100%\"}\n\n<br>\n\n::: {.callout-caution icon=\"true\"}\n## Bonnes pratiques : commenter ses scripts\n\nPrenez dès maintenant l'habitude de commenter vos scripts. Il s'agit de rédiger des commentaires qui expliquent ce que fait votre code, pour le rendre plus compréhensible par vos collègues - et par vous-même quand vous reviendrez sur un script après un certain temps !\n\nPour ajouter un commentaire, utilisez un `#` au début d'une ligne puis rédigez votre commentaire. Dans R, un code placé après un `#` n'est pas exécuté :\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ceci est un commentaire qui ne sera pas exécuté\n# La ligne suivante sera exécutée\n2 + 2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 4\n```\n:::\n:::\n\n:::\n\n<br>\n\nPour commencer, ajoutons des informations en haut de notre script :\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ateliers codons\n# Premiers pas avec R\n# 2022-11-07\n\n# Importer le jeu de donnees\n\npingouins <- read.csv(\"raw/pingouins.csv\", check.names = FALSE)\n```\n:::\n\n\n<br>\n\n::: {.callout-tip icon=\"true\"}\n## Raccourcis clavier : commentaires\n\nPour commenter ou dé-commenter des lignes de code, utilisez la combinaison **Ctrl + Shift + C**.\n:::\n\n\n<br>\n\nAvant d'aller plus loin, sauvegardez votre script en cliquant sur l'icône disquette en haut de votre script :\n\n![](img/rstudio_30.png){width=\"100%\"}\n\nChoisissez le dossier où sera sauvegardé votre script - **scripts** dans notre cas, et nommez votre script puis cliquez sur **Save** :\n\n![](img/rstudio_19.png){width=\"100%\"}\n\n::: {.callout-tip icon=\"true\"}\n## Raccourcis clavier : sauvegarder un script\n\nPour sauvegarder un script, uilisez la combinaison **Ctrl + S**\n:::\n\n<br>\n\n# Explorer des données\n\nAvant de débuter une analyse des données, il est toujours utile d'explorer rapidement ces données afin de s'assurer qu'elles ont été correctement importées, que les variables numériques sont effectivement des nombres et pas des chaînes de caractères, ...\n\n::: {.callout-note icon=\"true\"}\n\nCette première étape consistant à vérifier les données, le code utilisé peut être tapé directement dans la console. Le script contiendra plutôt le code utilisé pour nettoyer les données, ainsi que toutes les étapes ultérieures de l'analyse.\n\n:::\n\nCommençons par regarder à quel structure de données nous avons affaire : \n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(pingouins)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"data.frame\"\n```\n:::\n:::\n\n\nQuel type de données contient la variable Espece ?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntypeof(pingouins$Espece)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"character\"\n```\n:::\n:::\n\n\n\n::: {.callout-tip icon=\"true\"}\n\n## Les structures et types de données dans R\n\nIl existe plusieurs structures de données : \n\n- Un *vecteur* est un objet à une dimension contenant une chaîne d'éléments d'un seul type  \n- Un **facteur** est un vecteur contenant un nombre limité de modalités  \n\n- Un *data frame* est un tableau dont les colonnes (des vecteurs) peuvent être de différents types  \n\n- Une *matrice* est un tableau ne contenant qu'un seul type de données\n\n- Une *liste* peut contenir différents éléments (un vecteur, un data frame, ...)\n\n<br>\n\nCes structures peuvent contenir différents types de données : \n\n- des *caractères* \n\n- des *nombres entiers*  \n\n- des *nombres décimaux* (dans R, le séparateur décimal est le point `.`)  \n\n- des *opérateurs logiques* (TRUE ou FALSE)\n\n:::\n\n<br>\n\nVous pouvez afficher les dimensions et la structure des données : \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Dimensions du tableau (nb lignes par nb colonnes)\ndim(pingouins)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 344   9\n```\n:::\n\n```{.r .cell-code}\n# Structure du tableau\nstr(pingouins)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t344 obs. of  9 variables:\n $ etudeNumero         : chr  \"PAL0708\" \"PAL0708\" \"PAL0708\" \"PAL0708\" ...\n $ Echantillon Numero  : int  1 2 3 4 5 6 7 8 9 10 ...\n $ Espece              : chr  \"Adelie Penguin (Pygoscelis adeliae)\" \"Adelie Penguin (Pygoscelis adeliae)\" \"Adelie Penguin (Pygoscelis adeliae)\" \"Adelie Penguin (Pygoscelis adeliae)\" ...\n $ Ile                 : chr  \"Torgersen\" \"Torgersen\" \"Torgersen\" \"Torgersen\" ...\n $ ID Individu         : chr  \"N1A1\" \"N1A2\" \"N2A1\" \"N2A2\" ...\n $ Longueur Bec (mm)   : num  39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...\n $ Hauteur Bec (mm)    : num  18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...\n $ Longueur Aile (mm)  : int  181 186 195 NA 193 190 181 195 193 190 ...\n $ Masse corporelle (g): int  3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...\n```\n:::\n:::\n\n\n::: {.callout-note icon=\"true\"}\n## Note\n\nVous remarquerez que la fonction `str(pingouins)` affiche des informations très proches de celles obtenues en cliquant sur la flèche bleue à gauche de l'objet pingouins dans l'environnement.\n:::\n\n<br>\n\nLes fonctions suivantes permettent l'afficher le début ou la fin du tableau :\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Afficher les premieres lignes du tableau\nhead(pingouins)\n\n# Afficher les dernieres lignes du tableau\ntail(pingouins)\n```\n:::\n\n\n<br>\n\n::: {.callout-tip icon=\"true\"}\n## Afficher l'aide d'une fonction\n\nVous pouvez afficher l'aide d'une fonction de deux manières :\n\n- taper `help(fonction)` (pensez à l'auto-complétion !)\n\n- taper `?fonction`\n\nEssayez en tapant dans la console `?he` puis appuyez sur **Tab** : R vous propose une liste de fonctions commençant par **he**. Utilisez les flèches haut et bas pour choisir la fonction **head**. Une petite fenêtre vous donne un aperçu du contenu de l'aide pour la fonction (utile quand vous hésitez entre plusieurs fonctions). Une fois la fonction sélectionnée, appuyez sur la touche **F1** pour afficher l'aide complète dans l'onglet **Help**.\n\nL'aide d'une fonction contient plusieurs paragraphes :\n\n- **Description** : présentation sommaire de la fonction\n\n- **Usage** :  comment utiliser la fonction \n\n- **Arguments** : ils peuvent être obligatoires ou optionnels\n\n- **Details** : format de données à fournir en entrée, précisions sur les arguments, ...\n\n- **Value** : type d'objet obtenu en sortie\n\n- **Note** :  informations additionnelles\n\n- **Author(s)** :  personnes ayant contribué à l'écriture du code de la fonction\n\n- **Examples** :  exemples d'utilisation, avec la possibilité d'exécuter ces exemples\n\nDans le cas de `head()`, vous pouvez voir que par défaut, la fonction retournera les 6 premières lignes (`n = 6L`, **L** indiquant qu'il s'agit d'un nombre entier). Pour afficher uniquement les deux premières lignes du tableau *pingouins*, il vous faudrait modifier cet argument : `head(pingouins, n = 2L)`\n:::\n\nLa fonction `table()` permet d'extraire d'une variable les observations uniques et d'afficher le nombre de fois qu'elles apparaissent : \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(pingouins$Espece)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n      Adelie Penguin (Pygoscelis adeliae) \n                                      152 \nChinstrap penguin (Pygoscelis antarctica) \n                                       68 \n        Gentoo penguin (Pygoscelis papua) \n                                      124 \n```\n:::\n:::\n\n\n\n<br>\n\nVous pouvez explorer une variable d'intérêt à l'aide de l'opérateur `$` :\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Afficher les premiers elements d'une variable\nhead(pingouins$`Masse corporelle (g)`)\n\n# Afficher les derniers elements d'une variable\ntail(pingouins$`Masse corporelle (g)`)\n\n# Afficher le type, le nombre d'elements et les premiers elements d'une variable\nstr(pingouins$`Masse corporelle (g)`)\n```\n:::\n\n\n\n<br>\n\nLa fonction `summary()` est particulièrement intéressante pour avoir une vue d'ensemble de vos données.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(pingouins)\n```\n:::\n\n\n![](img/rstudio_22.png){width=\"100%\"}\n\nLes informations affichées  dépendent du type de variable :\n\n-   **nombre d'éléments, classe et mode** pour les variables de type **caractère**\\\n-   **statistiques** pour les variables de type **numérique**\n\n::: {.callout-tip icon=\"true\"}\n## Les données manquantes\n\nVous pouvez trouver dans vos données des éléments notés **NA**. Il s'agit d'une donnée manquante (**Not Available**) : aucune donnée n'existe pour ce cas précis.\n\nCette valeur **NA** est à différencier de la valeur **NaN (Not a Number)** également rencontrée dans R. Il s'agit alors du résultat d'une opération arithmétique invalide, telle que 0/0.\n:::\n\n<br>\n\n# Manipuler des données\n\n## Sélectionner et filtrer des données\n\n<br>\n\nDans R, la sélection de données, que ce soit une cellule, une ligne ou une colonne d'un tableau, ou encore un élément dans une chaîne, s'effectue à l'aide des **crochets \\[\\]**.\n\n- Imaginons un *vecteur v*, donc un objet à une seule dimension. Vous pouvez sélectionner un seul élément (`v[2]`), plusieurs éléments qui se suivent (`v[2:4]`) ou non (`v[c(2, 4)]`).\n\n![](img/rstudio_27.png){width=\"75%\"}\n\n::: {.callout-tip icon=\"true\"}\n## La concaténation\n\nLa fonction `c()` permet de concaténer les éléments entre parenthèses.\n:::\n\n- Imaginons un *data frame d*, la sélection s'effectue toujours à l'aide des crochets, mais en précisant deux paramètres séparés d'une virgule : la ou les ligne(s) et la ou les colonnes(s). Pour sélectionner l'ensemble d'une des deux dimensions, on utilise un espace vide d'un côté ou de l'autre de la virgule.\n\n![](img/rstudio_28.png){width=\"75%\"}\n\n<br>\n\nCertaines colonnes du tableau ne sont seront pas utiles pour la suite de l'analyse. Nous pouvons soit : \n\n- sélectionner les colonnes qui nous intéressent\n\n::: {.cell}\n\n```{.r .cell-code}\npingouins[, c(3, 6:9)]\n```\n:::\n\n\n- supprimer les colonnes inutiles\n\n::: {.cell}\n\n```{.r .cell-code}\npingouins[, -c(1:2, 4:5)]\n```\n:::\n\n\nCes deux commandes utilisent les index des colonnes. Vous pouvez également sélectionner ou supprimer des colonnes à l'aide de noms des variables : \n\n\n::: {.cell}\n\n```{.r .cell-code}\npingouins[, c(\"Espece\", \"Longueur Bec (mm)\", \"Hauteur Bec (mm)\",\n              \"Longueur Aile (mm)\", \"Masse corporelle (g)\")]\n```\n:::\n\n\n<br>\n\nAssignons ce nouveau tableau dans un objet : \n\n\n::: {.cell}\n\n```{.r .cell-code}\npingouins_propre <- pingouins[, c(\"Espece\", \"Longueur Bec (mm)\",\n                                  \"Hauteur Bec (mm)\",\"Longueur Aile (mm)\",\n                                  \"Masse corporelle (g)\")]\n```\n:::\n\n\n<br>\n\nNous pouvons filtrer les données selon différents critères, à l'aide d'opérateurs.\n\n::: {.callout-tip icon=\"true\"}\n## Les opérateurs\n\n|       |                     | \n| :---: | :------------------ |\n| ==    | égal                |\n| !=    | différent           |\n| <     | inférieur à         |\n| <=    | inférieur ou égal à |\n| >     | supérieur à         |\n| >=    | supérieur ou égal à |\n| ==    | égal                |\n| &     | et                  |\n| \\|    | ou                  |\n| !     | pas                 | \n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Individus de l'espece Adelie\npingouins_propre[pingouins_propre$espece == \"Adelie\", ]\n\n# Individus dont la masse est d'au moins 5 kgs\npingouins_propre[pingouins_propre$masse_corporelle_g >= 5000, ]\n\n# Individus de l'espece Adelie dont le bec mesure moins de 40mm de long\npingouins_propre[pingouins_propre$espece == \"Adelie\" & pingouins_propre$longueur_bec_mm >= 40, ]\n```\n:::\n\n\n## Renommer des colonnes\n\nLes noms des colonnes ne sont pas dans un format idéal (présence d'espaces, de parenthèses). \n\nLa fonction `names()` permet d'accéder aux noms des colonnes d'un tableau : \n\n::: {.cell}\n\n```{.r .cell-code}\nnames(pingouins_propre)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Espece\"               \"Longueur Bec (mm)\"    \"Hauteur Bec (mm)\"    \n[4] \"Longueur Aile (mm)\"   \"Masse corporelle (g)\"\n```\n:::\n:::\n\n\n<br>\n\nNous allons modifier les noms de colonnes en :\n\n- supprimant les parenthèses \n\n- remplaçant les espaces par des `_` \n\n- remplaçant les majuscules par des minuscules\n\n<br>\n\nLa fonction `gsub()` qui permet de remplacer un motif par un autre dans une chaîne, s'utilise de la manière suivante : `gsub(motif, remplacement, objet)`\n\nCommençons par supprimer les parenthèses. Nous allons pour cela utiliser une **expression régulière** : le motif recherché est soit une parenthèse ouverte soit une parenthèse fermée.   \n\n::: {.cell}\n\n```{.r .cell-code}\nnouveaux_noms <- gsub(\"[()]\", \"\", names(pingouins_propre))\n```\n:::\n\n\nRemplaçons maintenant les espaces par des `_` : \n\n\n::: {.cell}\n\n```{.r .cell-code}\nnouveaux_noms <- gsub(\" \", \"_\", nouveaux_noms)\n```\n:::\n\n\nLa fonction `tolower()` permet de remplacer les majuscules d'une chaîne de caractères par des minuscules (à l'inverse de la fonction `toupper()`) : \n\n\n::: {.cell}\n\n```{.r .cell-code}\nnouveaux_noms <- tolower(nouveaux_noms)\n```\n:::\n\n\nRemplaçons les noms de colonnes du tableau par ce vecteur *nouveaux_noms* : \n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(pingouins_propre) <- nouveaux_noms\n```\n:::\n\n\nAssurons-nous que notre tableau contient bien les nouveaux noms de colonnes : \n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(pingouins_propre)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"espece\"             \"longueur_bec_mm\"    \"hauteur_bec_mm\"    \n[4] \"longueur_aile_mm\"   \"masse_corporelle_g\"\n```\n:::\n:::\n\n\n<br>\n\n::: {.callout-tip icon=\"true\"}\n\nLorsque nous utilisons une flèche d'assignation, le résultat du code exécuté ne s'affiche pas dans la console. Pour éviter de taper le nom de l'objet que l'on souhaite afficher pour vérifier que le code a bien fonctionné, nous pouvons entourer le code par des parenthèses : \n\n::: {.cell}\n\n```{.r .cell-code}\n(names(pingouins_propre) <- nouveaux_noms)\n```\n:::\n\n\nLe résultat de la commande s'affiche maintenant dans la console.\n\n:::\n\n<br>\n\nNous pouvons maintenant supprimer l'objet nouveaux_noms de notre environnement à l'aide de la fonction `rm()` (remove) : \n\n::: {.cell}\n\n```{.r .cell-code}\nrm(nouveaux_noms)\n```\n:::\n\n\n::: {.callout-tip icon=\"true\"}\n\n## Supprimer des objets\n\nVous pouvez également supprimer des objets directement dans le panneau Environnement : \n\n- Sur la droite du panneau, cliquez sur *List* puis sur *Grid*\n\n![](img/rstudio_33.png){width=\"100%\"}\n\n- Cochez les objets à supprimer puis cliquez sur le balai\n\n![](img/rstudio_34.png){width=\"100%\"}\n\nAttention : si vous cliquez sur le balai alors que les objets sont sous forme de liste, vous supprimerez tous les objets de votre environnement.\n\n:::\n\n<br>\n\n## Modifier une variable\n\nLes noms d'espèces contenus dans la variable espece sont plutôt longs et peu pratiques à manipuler. Nous allons modifier le contenu de cette variable pour ne garder que le premier mot de chaque chaîne de caractères (Adelie, Chinstrap et Gentoo). Nous allons à nouveau utiliser la fonction `gsub()` avec une expression régulière pour supprimer tout ce qui vient après le premier espace (nous pourrions également extraire tout ce qui vient avant le premier espace).\n\n\n::: {.cell}\n\n```{.r .cell-code}\npingouins_propre$espece <- gsub(\" .*$\", \"\", pingouins_propre$espece)\nhead(pingouins_propre)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  espece longueur_bec_mm hauteur_bec_mm longueur_aile_mm masse_corporelle_g\n1 Adelie            39.1           18.7              181               3750\n2 Adelie            39.5           17.4              186               3800\n3 Adelie            40.3           18.0              195               3250\n4 Adelie              NA             NA               NA                 NA\n5 Adelie            36.7           19.3              193               3450\n6 Adelie            39.3           20.6              190               3650\n```\n:::\n:::\n\n\n::: {.callout-note icon=\"true\"}\n\n## Note\n\nDans cette expression régulière (regex), le motif recherché est le suivant : un espace vide (` `) suivi de n'importe quel caractère (`.`) absent ou répété au moins une fois (`*`), en fin de chaîne (`$`).\n\n:::\n\n<br>\n\n## Ajouter une variable\n\nQuel est le rapport entre la longueur du bec et sa hauteur ? Calculons le ratio : \n\n::: {.cell}\n\n```{.r .cell-code}\npingouins_propre$ratio_bec <- pingouins_propre$longueur_bec_mm / pingouins_propre$hauteur_bec_mm\n```\n:::\n\n\n<br>\n\nPour arrondir ce ratio à deux chiffres après la virgules, nous pouvons utiliser la fonction `round()` : \n\n\n::: {.cell}\n\n```{.r .cell-code}\npingouins_propre$ratio_bec <- round(pingouins_propre$ratio_bec, digits = 2)\n```\n:::\n\n\n<br>\n\n## Supprimer les données manquantes\n\nNotre jeu de données contient des données manquantes (**NA**). En affichant les premières lignes, vous pourrez remarquer que pour l'individu situé sur la quatrième ligne, aucune donnée numérique n'est disponible : \n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(pingouins_propre)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  espece longueur_bec_mm hauteur_bec_mm longueur_aile_mm masse_corporelle_g\n1 Adelie            39.1           18.7              181               3750\n2 Adelie            39.5           17.4              186               3800\n3 Adelie            40.3           18.0              195               3250\n4 Adelie              NA             NA               NA                 NA\n5 Adelie            36.7           19.3              193               3450\n6 Adelie            39.3           20.6              190               3650\n  ratio_bec\n1      2.09\n2      2.27\n3      2.24\n4        NA\n5      1.90\n6      1.91\n```\n:::\n:::\n\n\nPour savoir combien de données manquantes sont présentes dans vos données, vous pouvez utiliser la commande suivante : \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(is.na(pingouins_propre))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFALSE  TRUE \n 2054    10 \n```\n:::\n:::\n\n\nNos données contiennent 10 valeurs NA, nous en avons déjà trouvé 5 dans les premières lignes du tableau. Les 5 données manquantes restantes viennent-elles de l'absence de mesure pour un second individu ? La fonction `complete.cases()` permet d'extraires les lignes d'un tableau pour lesquelles il n'y a aucune donnée manquante. Nous cherchons à extraire les lignes qui contiennent au moins une donnée manquante. Pour cela nous allons filtrer les données en extrayant les lignes à l'aide de l'opétateur de négation `!` : \n\n\n::: {.cell}\n\n```{.r .cell-code}\npingouins_propre[!complete.cases(pingouins_propre), ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    espece longueur_bec_mm hauteur_bec_mm longueur_aile_mm masse_corporelle_g\n4   Adelie              NA             NA               NA                 NA\n272 Gentoo              NA             NA               NA                 NA\n    ratio_bec\n4          NA\n272        NA\n```\n:::\n:::\n\n\nNous avons ici les dix données manquantes. Nous allons supprimer ces deux individus du jeu de données : \n\n\n::: {.cell}\n\n```{.r .cell-code}\npingouins_propre <- pingouins_propre[complete.cases(pingouins_propre), ]\n```\n:::\n\n\nNous aurions également pu supprimer les lignes pour lesquelles une des variables numériques contient des données manquantes : \n\n\n::: {.cell}\n\n```{.r .cell-code}\npingouins_propre <- pingouins_propre[!is.na(pingouins_propre$longueur_bec_mm), ]\n```\n:::\n\n\nAssurons-nous d'avoir bien supprimé ces données manquantes : \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(is.na(pingouins_propre))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFALSE \n 2052 \n```\n:::\n:::\n\n\n<br>\n\n## Transformer un vecteur en un facteur\n\nAffichons la synthèse de nos données\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(pingouins_propre)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    espece          longueur_bec_mm hauteur_bec_mm  longueur_aile_mm\n Length:342         Min.   :32.10   Min.   :13.10   Min.   :172.0   \n Class :character   1st Qu.:39.23   1st Qu.:15.60   1st Qu.:190.0   \n Mode  :character   Median :44.45   Median :17.30   Median :197.0   \n                    Mean   :43.92   Mean   :17.15   Mean   :200.9   \n                    3rd Qu.:48.50   3rd Qu.:18.70   3rd Qu.:213.0   \n                    Max.   :59.60   Max.   :21.50   Max.   :231.0   \n masse_corporelle_g   ratio_bec    \n Min.   :2700       Min.   :1.640  \n 1st Qu.:3550       1st Qu.:2.160  \n Median :4050       Median :2.575  \n Mean   :4202       Mean   :2.606  \n 3rd Qu.:4750       3rd Qu.:3.100  \n Max.   :6300       Max.   :3.610  \n```\n:::\n:::\n\n\nLa variable espece est considérée comme une simple chaîne de caractère. S'agit-il d'une variable ayant un nombre restreint de modalités ? Pour le savoir, comptons le nombre d'observations uniques :\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlength(unique(pingouins_propre$espece))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3\n```\n:::\n:::\n\n\nNous aurions pu également utiliser la fonction `table()` pour extraire les modalités et leur fréquence : \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(pingouins_propre$espece)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n   Adelie Chinstrap    Gentoo \n      151        68       123 \n```\n:::\n:::\n\n\n\n<br>\n\nIl n'y a que trois modalités possibles pour cette variable : il s'agit d'une variable catégorielle. La fonction `as.factor()` permet de transformer un vecteur en un facteur. Par défaut, les modalités (niveaux) d'un facteur sont classés par ordre alphabétique. Vous pouvez définir l'ordre des niveaux à l'aide de l'argument `levels = ...`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npingouins_propre$espece <- as.factor(pingouins_propre$espece)\n```\n:::\n\n\nVérifiez que les corrections apportées aient bien été appliquées au jeu de données :\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(pingouins_propre)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       espece    longueur_bec_mm hauteur_bec_mm  longueur_aile_mm\n Adelie   :151   Min.   :32.10   Min.   :13.10   Min.   :172.0   \n Chinstrap: 68   1st Qu.:39.23   1st Qu.:15.60   1st Qu.:190.0   \n Gentoo   :123   Median :44.45   Median :17.30   Median :197.0   \n                 Mean   :43.92   Mean   :17.15   Mean   :200.9   \n                 3rd Qu.:48.50   3rd Qu.:18.70   3rd Qu.:213.0   \n                 Max.   :59.60   Max.   :21.50   Max.   :231.0   \n masse_corporelle_g   ratio_bec    \n Min.   :2700       Min.   :1.640  \n 1st Qu.:3550       1st Qu.:2.160  \n Median :4050       Median :2.575  \n Mean   :4202       Mean   :2.606  \n 3rd Qu.:4750       3rd Qu.:3.100  \n Max.   :6300       Max.   :3.610  \n```\n:::\n:::\n\n\n<!-- ![](img/rstudio_23.png){width=\"100%\"} -->\n\n\n\n<br>\n\n::: {.callout-caution icon=\"true\"}\n## Bonne pratiques : structurer son script\n\nVotre script commence à être bien fourni. Vous pouvez le diviser en différentes parties pour simplifier la lecture. Pour cela, ajoutez des titres sous forme de commentaires et accolez des tirets (au moins quatre) pour signaler à R qu'il s'agit de divisions dans votre script.\n\n![](img/rstudio_24.png){width=\"100%\"}\n\nEn cliquant sur l'icône **Menu** à droite vous aurez accès à une table des matières dans laquelle vous pourrez naviguer en cliquant sur la partie qui vous intéresse.\n\n![](img/rstudio_25.png){width=\"100%\"}\n:::\n\n<br>\n\n::: {.callout-tip icon=\"true\"}\n## Raccourcis clavier : les sections d'un script\n\nPour afficher le sommaire de votre script, utilisez la combinaison **Ctrl + Shift + O**.\\\nVous pouvez également replier (**Alt + O**) ou déplier (**Alt + Shift + O**) les sections.\n:::\n\n<br>\n\n## Exporter des données\n\nLa fonction `write.csv()` permet d'exporter un tableau : \n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv(pingouins_propre, \"data/pingouins_propre.csv\")\n```\n:::\n\n\n\n# Représenter des données",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}